# vpsetup

**vpsetup** is a curses-based TUI tool for setting up a WireGuard server on a VPS, specifically designed to work around CGNAT environments (such as Starlink Residential) by enabling inbound access via a reverse VPN tunnel.

This project automates the boring, failure-prone parts of VPS networking setup while still keeping everything transparent, inspectable, and under your control.

---

## Why this exists

If your ISP uses CGNAT, you cannot forward inbound ports directly. This tool solves that by:

- Using a VPS with a public IPv4 address
- Establishing a persistent outbound WireGuard tunnel from your private network
- Optionally forwarding inbound VPS ports across the tunnel to your internal host

Result: **it behaves like you have a public IP**, without paying CGNAT ransom fees.

---

## Features

- Interactive **curses TUI** (no web UI, no browser nonsense)
- Zero cloud dependencies
- Fully automated WireGuard server setup
- Automatic IPv4 forwarding + NAT
- Optional DNAT port forwarding (VPS → WireGuard client)
- Client config generation
- QR code output for mobile clients
- Designed for Debian / Ubuntu VPS images
- Clean PEP 621 + Poetry 2.x project layout

---

## Project layout

```
vpsetup/
├── pyproject.toml
├── poetry.lock
├── README.md
└── vpsetup/
    ├── __init__.py
    └── __main__.py
```

The entry point is defined as:

```
vpsetup = vpsetup.__main__:main
```

You can run it either as a script or a module.

---

## Requirements

- Linux VPS (Debian or Ubuntu recommended)
- Root access
- Python 3.10+
- Public IPv4 address on the VPS

The script will install required system packages automatically:

- wireguard
- iptables
- iptables-persistent
- qrencode

---

## Installation

Clone the repository on your VPS:

```bash
git clone https://github.com/YOURNAME/vpsetup.git
cd vpsetup
```

Install with Poetry:

```bash
poetry install
```

---

## Usage

Run via Poetry:

```bash
poetry run vpsetup
```

Or directly as a module:

```bash
python -m vpsetup
```

The TUI will guide you through:

1. WireGuard interface and port selection
2. VPN subnet configuration
3. Client routing behavior
4. Optional inbound port forwarding rules
5. Firewall/NAT setup
6. Client config generation

Client configs are written to:

```
/root/wireguard-clients/
```

---

## Typical use case (Starlink example)

```
Internet
   ↓
[VPS public IP]
   ↓ (DNAT)
[WireGuard tunnel]
   ↓
[Starlink network]
   ↓
[Internal server]
```

Inbound traffic hits the VPS, is forwarded through WireGuard, and arrives at your internal service — no ISP port forwarding required.

---

## Security notes

- WireGuard keys are generated locally on the VPS
- Config files are written with restrictive permissions (0600)
- No telemetry, analytics, or remote calls
- Firewall rules are explicit and persistent
- You are encouraged to review all generated configs

This tool prioritizes **control and clarity over magic**.

---

## Limitations

- Designed for iptables (nftables compatibility via iptables-nft)
- One client generated by default (extendable)
- Static port forwards must be managed consciously
- Not a replacement for full configuration management

---

## License

MIT

---

## Author

DJ Stomp  
85457381+DJStompZone@users.noreply.github.com
